(function(n){var l=window.AmazonUIPageJS||window.P,p=l._namespace||l.attributeErrors,q=p?p("BrandFollowButtonJS",""):l;q.guardFatal?q.guardFatal(n)(q,window):q.execute(function(){n(q,window)})})(function(n,l,p){var q="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},z=function(){function g(b,a){for(var e=0;e<a.length;e++){var f=a[e];f.enumerable=
f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(b,a,e){a&&g(b.prototype,a);e&&g(b,e);return b}}();n.when("A").register("brand-follow-constants",function(){return{Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR:"span[class*\x3dbrand-follow-button-container]",Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR:"span[class*\x3dbrand-follow-button]",Brand_FOLLOW_BUTTON_SELECTOR:"button[data-bfid]",Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR:'button[data-bfid][data-showtooltip\x3d"true"]',
BRAND_FOLLOW_STATUS_MAP:"brand-follow-status",BRAND_FOLLOW_STATUS:{FOLLOWING:"following",NOT_FOLLOWING:"not_following",PENDING:"pending",NOT_SIGNED_IN:"not_signed_in",ERROR:"error"},BRAND_FOLLOW_CSRF_KEY:"brand-follow-csrf",BRAND_FOLLOW_CSRF_DATA_KEY:"csrf",BRAND_FOLLOW_LAST_CLICK_EVENT_MAP:"brand-follow-last-click-event-map",BFID_DATA_KEY:"bfid",FOLLOW_STATUS_DATA_KEY:"followstatus",FOLLOW_TEXT_DATA_KEY:"followtext",FOLLOWING_TEXT_DATA_KEY:"followingtext",REQUEST_ID_DATA_KEY:"requestid",PLACEMENT_TYPE_DATA_KEY:"placementtype",
PLACEMENT_SUB_TYPE_DATA_KEY:"placementsubtype",PLACEMENT_ID_DATA_KEY:"placementid",COMPONENT_TYPE_DATA_KEY:"componenttype",COMPONENT_ID_DATA_KEY:"componentid",ELEMENT_TYPE_DATA_KEY:"elementtype",ELEMENT_ID_DATA_KEY:"elementid",TOOLTIP_TEXT_DATA_KEY:"tooltiptext",BACK_BUTTON_SUPPORT_ENABLED_DATA_KEY:"backbuttonsupportenabled",ARIA_LABEL_KEY:"aria-label",ARIA_LABEL_FOLLOW_DATA_KEY:"arialabelfollow",ARIA_LABEL_FOLLOWING_DATA_KEY:"arialabelfollowing",FOLLOWED_BRAND_TOOLTIP_SIGNAL:"followed_brand_signal",
TOOLTIP_LAST_SEEN_KEY:"tooltip_last_seen",TOOLTIP_LATEST_TEXT_KEY:"tooltip_latest_text",TOOLTIP_SEEN_COUNTER:"tooltip_seen_counter",TOOLTIP_DISPLAY_TIME:5E3,TOOLTIP_STATUS_SHOWN:"SHOWN",TOOLTIP_STATUS_NOT_SHOWN:"NOT_SHOWN",TOOLTIP_STATUS_DISABLED:"DISABLED",FOLLOW_AJAX_TIMEOUT:2E3,FOLLOW_AJAX_RETRIES:2,FOLLOW_ENDPOINT:"/followv2/follow",FOLLOW_ENTITY_TYPE:"brand",FOLLOW_REF_TAG:"bft",FOLLOW_CSM_PREFIX:"BrandFollow",FOLLOW_CSM_SUCCESS:"Success",FOLLOW_CSM_FAIL:"Fail",FOLLOW_CSM_FOLLOW:"Follow",FOLLOW_CSM_UNFOLLOW:"Unfollow",
FOLLOW_CSM_GET_FOLLOW_STATUS:"GetFollowStatus",HTTP_GET:"GET",HTTP_POST:"POST",HTTP_DELETE:"DELETE",SIGN_IN_PORTAL:"/ap/signin",AUTH_PORTAL_ASSOC_HANDLE:{"amazon.com":"usflex","amazon.co.uk":"gbflex","amazon.de":"deflex","amazon.fr":"frflex","amazon.es":"esflex","amazon.in":"inflex","amazon.it":"itflex","amazon.co.jp":"jpflex","amazon.ca":"caflex"},BREAKPOINTS:{MOBILE:840},SUSHI_ENDPOINT:{gamma:"https://unagi-na.amazon.com/1/events/com.amazon.eel.BrandFollowButtonMetrics.Gamma.ClientEvents",prod:"https://unagi-na.amazon.com/1/events/com.amazon.eel.BrandFollowButtonMetrics.Prod.ClientEvents"},
EVENT_TYPE:{FOLLOW:"Follow",UNFOLLOW:"Unfollow"}}});"use strict";n.when("A","brand-follow-constants").register("brand-follow-auth-portal-link-builder",function(g,b){return{signin:function(){var a={"openid.ns":"http://specs.openid.net/auth/2.0","openid.claimed_id":"http://specs.openid.net/auth/2.0/identifier_select","openid.identity":"http://specs.openid.net/auth/2.0/identifier_select","openid.mode":"checkid_setup","openid.return_to":l.location.href,"openid.assoc_handle":b.AUTH_PORTAL_ASSOC_HANDLE[l.location.hostname.replace(/.+?(?=amazon)/,
"")]};return b.SIGN_IN_PORTAL+"?"+g.$.param(a)}}});"use strict";n.register("brand-follow-csm-helper",function(){return{incrementCSMCounter:function(g,b){l.ue&&l.ue.count&&l.ue.count(g,(l.ue.count(g)||0)+1,b)},logBodyBegin:function(g){"function"==typeof uet&&uet("bb",g,{wb:1})},sendCsmMetrics:function(g){"function"==typeof uex&&uex("ld",g,{wb:1})}}});"use strict";n.when("A","brand-follow-constants","brand-follow-csm-helper").register("brand-follow-data-storage-helper",function(g,b,a){var e={set:function(a,
b,e){var h={};h[b]=e;g.state(a,h)},get:function(a){return g.state(a)},setFollowStatus:function(a,k){e.set(b.BRAND_FOLLOW_STATUS_MAP,a,k)},getFollowStatus:function(a){var k=e.get(b.BRAND_FOLLOW_STATUS_MAP);return k===p?p:k[a]},setLastClickEvent:function(a,k){e.set(b.BRAND_FOLLOW_LAST_CLICK_EVENT_MAP,a,k)},getLastClickEvent:function(f){var k=b.FOLLOW_CSM_PREFIX+":dataStorageHelper:getLastClickAction";a.incrementCSMCounter(k);var m=e.get(b.BRAND_FOLLOW_LAST_CLICK_EVENT_MAP);if(m===p)return a.incrementCSMCounter(k+
":emptyMap"),p;(f=m[f])||a.incrementCSMCounter(k+":notFoundInMap");return f},setCsrf:function(a){e.set(b.BRAND_FOLLOW_CSRF_KEY,b.BRAND_FOLLOW_CSRF_DATA_KEY,a)},getCsrf:function(){var a=e.get(b.BRAND_FOLLOW_CSRF_KEY);return a===p?p:a[b.BRAND_FOLLOW_CSRF_DATA_KEY]}};return e});"use strict";n.when("A","brand-follow-constants","brand-follow-data-storage-helper","brand-follow-csm-helper").register("brand-follow-afs-helper",function(g,b,a,e){var f={makeCallToAfs:function(a,f,h,c,d,r){var u=b.FOLLOW_CSM_PREFIX+
":"+a;e.incrementCSMCounter(u);(function A(w){e.logBodyBegin(r);g.$.ajax({url:f,type:a,headers:{Accept:"application/json","Content-Type":"application/json"},data:h,dataType:"json",cache:!1,timeout:b.FOLLOW_AJAX_TIMEOUT,success:function(a,d,k){e.incrementCSMCounter(u+":"+b.FOLLOW_CSM_SUCCESS);e.sendCsmMetrics(r);"function"===typeof c&&c(a,d,k)},error:function(c,f,h){if("timeout"===f&&w)e.incrementCSMCounter(u+":timeout"),A(--w);else{var m=u+":"+b.FOLLOW_CSM_FAIL;e.incrementCSMCounter(m);"timeout"===
f&&e.incrementCSMCounter(m+":timeout");e.sendCsmMetrics(r);l.ueLogError&&l.ueLogError({logLevel:"WARN",attribution:"BrandFollowKataComponentAssets",message:"AFS "+a+" call failed with status "+f+", error thrown: "+h+", response text: "+c.responseText});"function"===typeof d&&d(c,f,h)}}})})(b.FOLLOW_AJAX_RETRIES)},getFollowStatusAndInitCsrf:function(e,m,h,c){f.makeCallToAfs(b.HTTP_GET,b.FOLLOW_ENDPOINT+"/"+e+"_"+b.FOLLOW_ENTITY_TYPE,{ref:b.FOLLOW_REF_TAG},function(d,b,e){d.signedIn?(a.setCsrf(d.csrf),
"function"===typeof m&&m(d)):"function"===typeof c&&c()},h,b.FOLLOW_CSM_PREFIX+":"+b.FOLLOW_CSM_GET_FOLLOW_STATUS)},follow:function(e,m,h,c){var d=b.FOLLOW_CSM_PREFIX+":"+b.FOLLOW_CSM_FOLLOW,r=function(){f.makeCallToAfs(b.HTTP_POST,b.FOLLOW_ENDPOINT,JSON.stringify({authenticity_token:a.getCsrf(),entity_id:e,category:b.FOLLOW_ENTITY_TYPE,ref:b.FOLLOW_REF_TAG}),m,h,d)};a.getCsrf()===p?f.getFollowStatusAndInitCsrf(e,r,p,c):r()},unfollow:function(e,m,h){var c=b.FOLLOW_CSM_PREFIX+":"+b.FOLLOW_CSM_UNFOLLOW,
d=function(){f.makeCallToAfs(b.HTTP_DELETE,b.FOLLOW_ENDPOINT+"/"+e+"_"+b.FOLLOW_ENTITY_TYPE+"?"+g.$.param({authenticity_token:a.getCsrf(),ref:b.FOLLOW_REF_TAG}),p,m,h,c)};a.getCsrf()===p?f.getFollowStatusAndInitCsrf(e,d):d()}};return f});"use strict";n.when("A").register("brand-follow-button-tooltip-factory",function(g){g=g.$;var b=g("\x3cdiv class\x3d'brand-follow-tooltip-root'/\x3e").appendTo("body");return{getOrCreateTooltip:function(){0===b.children().length&&b.append("\x3cdiv role\x3d'tooltip' class\x3d'bf-tooltip' id\x3d'bf-tooltip' aria-hidden\x3d'true' style\x3d'z-index: 299; visibility: hidden; opacity: 0;'\x3e\x3cdiv class\x3d'bf-tooltip-inner'\x3eFollow to see deals and more content from this brand on Amazon\x3c/div\x3e\x3cdiv class\x3d'bf-arrow-border'\x3e\x3cdiv class\x3d'bf-arrow'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");
return b.children().first()}}});"use strict";n.when("A").register("brand-follow-button-tooltip-position",function(g){function b(){if(1===g.viewport().zoom)return{top:0,left:0};h||(h=m('\x3cspan id\x3d"bf-tooltip-offset-tracker"\x3e\x3c/span\x3e'),m("body").prepend(h));var c;m.withoutRtl(function(){c=h.offset()});return c}function a(c,a){var e=g.viewport(),k=b(),f,h;m.withoutRtl(function(){f=a.offset();h=c.offset()});f.top-=k.top;f.left-=k.left;h.top-=k.top;h.left-=k.left;var l=a.outerWidth(),n=a.outerHeight(),
p=c.outerWidth(!0),q=c.outerHeight(!0);return{windowWidth:e.width,windowHeight:e.height,windowTop:e.scrollTop,windowLeft:e.scrollLeft,windowRight:e.scrollLeft+e.width,windowBottom:e.scrollTop+e.height,zoomTop:k.top,zoomLeft:k.left,triggerWidth:l+1,triggerHeight:n,triggerTop:f.top-1,triggerLeft:f.left-1,triggerRight:f.left+l+1,triggerBottom:f.top+n+1,triggerVerticalCenter:f.top+n/2,triggerHorizontalCenter:f.left+l/2,popoverWidth:p,popoverHeight:q,popoverTop:h.top,popoverLeft:h.left,popoverRight:h.left+
p,popoverBottom:h.top+q,popoverVerticalCenter:h.top+q/2,popoverHorizontalCenter:h.left+p/2}}function e(c){return c.removeClass("a-arrow-top a-arrow-bottom a-arrow-left a-arrow-right")}function f(c){var a={deltaTop:0},e;a.top=c.triggerVerticalCenter-c.popoverHeight/2;a.top<c.windowTop+15?(e=Math.min(c.windowTop+15,c.triggerTop-15),a.deltaTop=a.top-e,a.top=e):a.top+c.popoverHeight>c.windowBottom-15&&(e=Math.min(15,c.windowBottom-c.triggerBottom+15),a.deltaTop=a.top+c.popoverHeight-(c.windowBottom-e),
a.top=c.windowBottom-e-c.popoverHeight);return a}function k(a){var d={deltaLeft:0},e;d.left=a.triggerHorizontalCenter-a.popoverWidth/2;15>d.left?(e=Math.min(15,a.triggerLeft-15),d.deltaLeft=d.left-e,d.left=e):d.left+a.popoverWidth>a.windowRight-15&&(e=Math.min(15,a.windowRight-a.triggerRight+15),d.deltaLeft=d.left+a.popoverWidth-(a.windowRight-e),d.left=a.windowRight-e-a.popoverWidth);return d}var m=g.$;m(l);var h=null;return{windowCenter:function(c){c=a(c.$popover,c.$trigger);var d={};d.top=(c.windowHeight-
c.popoverHeight)/2;d.left=(c.windowWidth-c.popoverWidth)/2;0>d.top&&(d.top=0);return d},windowTop:function(c){c=a(c.$popover,c.$trigger);var d={top:0};d.left=c.windowWidth/2-c.popoverWidth/2;return d},windowFullWidth:function(a){return{top:0,left:0}},triggerRight:function(c,d){var b=c.$popover;c=c.$trigger;d||(d=a(b,c));c=f(d);c.left=d.triggerRight;e(b).addClass("a-arrow-right");b.find(".bf-arrow-border").css("top",d.popoverHeight/2+c.deltaTop);return c},triggerLeft:function(c,d){var b=c.$popover;
c=c.$trigger;d||(d=a(b,c));c=f(d);c.left=d.triggerLeft-d.popoverWidth;c.left=0<c.left?c.left:0;e(b).addClass("a-arrow-left");b.find(".bf-arrow-border").css("top",d.popoverHeight/2+c.deltaTop);return c},triggerTop:function(c,d){var b=c.$popover;c=c.$trigger;d||(d=a(b,c));c=k(d);c.top=d.triggerTop-d.popoverHeight;e(b).addClass("a-arrow-top");b.find(".bf-arrow-border").css("left",d.popoverWidth/2+c.deltaLeft);return c},triggerBottom:function(c,d){var b=c.$popover;c=c.$trigger;d||(d=a(b,c));c=k(d);c.top=
d.triggerBottom;e(b).addClass("a-arrow-bottom");b.find(".bf-arrow-border").css("left",d.popoverWidth/2+c.deltaLeft);return c},triggerHorizontal:function(c,d){var e=c.$popover,b=c.$trigger;d||(d=a(e,b));return d.triggerLeft-d.windowLeft>d.windowRight-d.triggerRight?this.triggerLeft(c,d):this.triggerRight(c,d)},triggerVertical:function(c,d){var e=c.$popover,b=c.$trigger;d=d?d:a(e,b);return d.triggerTop-d.windowTop>d.popoverHeight+15?this.triggerTop(c,d):this.triggerBottom(c,d)},triggerVerticalAlignLeft:function(c,
d){var b=c.$popover;c=c.$trigger;d||(d=a(b,c));c={};var k=0,f=0,h=d.windowBottom-d.triggerBottom;c.left=d.triggerLeft;c.top=h>d.popoverHeight?d.triggerBottom+3:d.triggerTop-d.popoverHeight-3;15>c.left?(f=Math.min(15,d.triggerLeft-15),k=c.left-f,c.left=f):c.left+d.popoverWidth>d.windowRight-15&&(f=Math.min(15,d.windowRight-d.triggerRight+15),k=c.left+d.popoverWidth-(d.windowRight-f),c.left=d.windowRight-f-d.popoverWidth);e(b).addClass(h>d.popoverHeight?"a-arrow-bottom":"a-arrow-top");m.withoutRtl(function(){b.find(".bf-arrow-border").css("left",
d.triggerWidth/2+k)});return c},triggerBottomAlignRight:function(c,d){var b=c.$popover;c=c.$trigger;d||(d=a(b,c));c={};var f=0,k=0,h=d.windowBottom-d.triggerBottom;c.left=d.triggerRight-d.popoverWidth;c.top=d.triggerBottom+3;15>c.left?(k=Math.max(0,c.left),f=k-c.left,c.left=k):c.left+d.popoverWidth>d.windowRight-15&&(k=Math.min(15,d.windowRight-d.triggerRight+15),f=c.left+d.popoverWidth-(d.windowRight-k),c.left=d.windowRight-k-d.popoverWidth);e(b).addClass(h>d.popoverHeight?"a-arrow-bottom":"a-arrow-top");
m.withoutRtl(function(){b.find(".bf-arrow-border").css("right",d.triggerWidth/2+f)});return c},customPosition:function(c,d){return d.call(this,{popover:c,$popover:c.$popover,$trigger:c.$trigger,measure:a})}}});"use strict";n.when("A","brand-follow-button-tooltip-factory","brand-follow-button-tooltip-position","brand-follow-constants").register("brand-follow-button-tooltip",function(g,b,a,e){var f=g.$;return{show:function(k){var m=b.getOrCreateTooltip(),h=f(k);k=h.data(e.TOOLTIP_TEXT_DATA_KEY);h=a.triggerBottomAlignRight({$popover:m,
$trigger:h});k&&m.find(".bf-tooltip-inner").first().text(k);m.css({top:h.top+"px",left:h.left+6+"px",visibility:"visible",opacity:1,transition:"opacity 0.5s"})},hide:function(){b.getOrCreateTooltip().css({visibility:"hidden",opacity:0,transition:"visibility 0s 0.5s, opacity 0.5s linear"})},getText:function(){return b.getOrCreateTooltip().find(".bf-tooltip-inner").first().text()}}});"use strict";n.register("brand-follow-sushi-client",function(){var g=["messageId","timestamp"];return function(){function b(a,
e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.endpoint=e;this.window=a;this.eventsQueue=[];this.eventsDictionary={};this.reverseEventsDictionary={};this.eventSequence=this.lowPriorityTimer=this.highPriorityTimer=this.rejectedEvents=this.dictionaryIndex=this.batchSize=0;this.unloadHandlerCalled=!1;this.highPriorityFlushInterval=1E3;this.lowPriorityFlushInterval=1E4;this.transportationClient=function(b){var e=function(){};b=function(){var b=function(){if(a.XDomainRequest){var c=
new a.XDomainRequest;c.onerror=e;c.ontimeout=e;c.onprogress=e;c.onload=e;c.timeout=0;return c}if(a.XMLHttpRequest){c=new a.XMLHttpRequest;if(!("withCredentials"in c))throw"";return c}return null};return{send:function(a,d){if(d&&a){var e=b();if(!e)throw"";e.open("POST",a,!0);e.setRequestHeader&&e.setRequestHeader("Content-type","text/plain");e.send(d)}},isSupported:!0}}();var m=function(){return{send:function(e,c){if(e&&c&&!a.navigator.sendBeacon(e,c))throw"";},isSupported:!!a.navigator.sendBeacon&&
!(a.cordova&&a.cordova.platformId&&"ios"===a.cordova.platformId)}}();return{ajaxClient:b,beaconClient:m}}(this);this.compressor=function(a){var e=function(c){if(c)switch("undefined"===typeof c?"undefined":q(c)){case "number":return!(c!==c||Infinity===c)&&c.toString().length>a.dictionaryIndex.length;case "boolean":break;case "string":return c.length>a.dictionaryIndex.length;default:return!0}return!1},b=function(c){a.eventsDictionary[c]||(a.eventsDictionary[c]=a.dictionaryIndex++,a.reverseEventsDictionary[a.eventsDictionary[c]]=
c);return a.eventsDictionary[c]},h=function(a){if(e(a)){var d=0;a instanceof Array?d=2:a instanceof Function?d=null:a instanceof Object&&(d=1);switch(d){case 0:return b(a);case 2:for(var f=[],d=0;d<a.length;d++)f[d]=h(a[d]);return f;case 1:d={};for(f in a)Object.prototype.hasOwnProperty.call(a,f)&&(d[b(f)]=-1===g.indexOf(f)?h(a[f]):a[f]);return d}}return a};return{compressData:h,buildPOSTObject:function(){return a.stringify({cs:{dct:a.reverseEventsDictionary},events:a.eventsQueue})}}}(this)}z(b,[{key:"onBeforeUnload",
value:function(){!0!==this.unloadHandlerCalled&&(this.flush(this),this.unloadHandlerCalled=!0)}},{key:"stringify",value:function(a){try{return JSON.stringify(a)}catch(e){console.warn("Fail to stringify data")}return null}},{key:"resetBatch",value:function(){this.eventsQueue=[];this.eventsDictionary={};this.reverseEventsDictionary={};this.highPriorityTimer=this.lowPriorityTimer=this.batchSize=this.dictionaryIndex=0}},{key:"sendWithClient",value:function(a){if(null==this.endpoint||""==this.endpoint)this.ueCount("SushiClientEndpointMissing");
else{if(a.isSupported){var e=this.compressor.buildPOSTObject();return a.send(this.endpoint,e)}throw"";}}},{key:"sendWithPriority",value:function(){for(var a=arguments.length,e=Array(a),b=0;b<a;b++)e[b]=arguments[b];for(a=0;a<e.length;a++){b=e[a];try{return this.sendWithClient(b)}catch(k){}}return null}},{key:"flush",value:function(a){a.eventsQueue.length&&(a.sendWithPriority(a.transportationClient.beaconClient||{},a.transportationClient.ajaxClient||{}),a.resetBatch())}},{key:"startHighPriorityQueueTimer",
value:function(){0===this.highPriorityFlushInterval?this.flush(this):this.highPriorityTimer||(this.highPriorityTimer=this.window.setTimeout(this.flush,this.highPriorityFlushInterval,this))}},{key:"startLowPriorityQueueTimer",value:function(){this.lowPriorityTimer||(this.lowPriorityTimer=this.window.setTimeout(this.flush,this.lowPriorityFlushInterval,this))}},{key:"generateMessageId",value:function(a,b){return a+"-"+b+"-"+this.eventSequence}},{key:"getCurrentISODate",value:function(){var a=new Date,
b=function(a){return 10>a?"0"+a:a};return Date.prototype.toISOString?a.toISOString():a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+String((a.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}},{key:"decorateEvent",value:function(a){a.timestamp=this.getCurrentISODate();a.sequence=this.eventSequence;a.messageId=this.generateMessageId(a.request_id,Date.now?Date.now():(new Date).getTime())}},{key:"startTimers",
value:function(a){(a||{}).n?this.startHighPriorityQueueTimer():this.startLowPriorityQueueTimer()}},{key:"encodeEvent",value:function(a,b,f){b=b.length;(499===this.eventsQueue.length||524288<this.batchSize+b)&&this.flush(this);this.batchSize+=b;a={data:this.compressor.compressData(a)};this.eventsQueue.push(a);this.startTimers(f)}},{key:"addEvent",value:function(a,b){this.decorateEvent(a,b);var f=this.stringify(a);return f?(this.encodeEvent(a,f,b),!0):!1}},{key:"isValidAPIParam",value:function(a,b){return a&&
-1<a.constructor.toString().indexOf(b)}},{key:"isMaxCallsReached",value:function(){this.eventSequence++;5E4<this.eventSequence&&this.ueCount("SushiClientMaxCallsReached");return 5E4<this.eventSequence}},{key:"isValidAPICall",value:function(a,b){return!this.isMaxCallsReached()&&this.isValidAPIParam(a,"Object")}},{key:"ueCount",value:function(a,b){"undefined"!==typeof ue&&ue&&ue.count&&ue.count("BrandFollowMetrics:"+a,0===b?0:b||(ue.count("BrandFollowMetrics:"+a)||0)+1)}},{key:"processEvent",value:function(a,
b){var f=this.unloadHandlerCalled=!1;this.options=b||{};this.isValidAPICall(a,this.options)&&(f=this.addEvent(a,this.options));f?this.ueCount("ClientEventsSuccess:"+a.event_type):(console.error("Invalid JS SushiEel API call"),this.ueCount("ClientEventsFailed:"+a.event_type));return f}}]);return b}()});"use strict";n.when("A","brand-follow-sushi-client","brand-follow-constants").register("brand-follow-metrics-client",function(g,b,a){var e=g.$;g=document.domain;g=0===g.indexOf("www.amazon")||0===g.indexOf("smile.amazon");
var f=new b(l,a.SUSHI_ENDPOINT[g?"prod":"gamma"]);return{getAttributeMapFromElement:function(b){var f=e(b).data(a.BFID_DATA_KEY),h=e(b).data(a.REQUEST_ID_DATA_KEY),c=e(b).data(a.PLACEMENT_TYPE_DATA_KEY),d=e(b).data(a.PLACEMENT_SUB_TYPE_DATA_KEY),g=e(b).data(a.PLACEMENT_ID_DATA_KEY),l=e(b).data(a.COMPONENT_TYPE_DATA_KEY),n=e(b).data(a.COMPONENT_ID_DATA_KEY),p=e(b).data(a.ELEMENT_TYPE_DATA_KEY);b=e(b).data(a.ELEMENT_ID_DATA_KEY);return{bfid:f,request_id:h,placement_type:c,placement_sub_type:d,placement_id:g,
component_type:l,component_id:n,element_type:p,element_id:b}},buildFollowButtonClickMetricEvent:function(a,b,e){a=this.getAttributeMapFromElement(a);return{bfid:a.bfid,request_id:a.request_id,placement_type:a.placement_type,placement_sub_type:a.placement_sub_type,placement_id:a.placement_id,component_type:a.component_type,component_id:a.component_id,element_type:a.element_type,element_id:a.element_id,event_type:b,tooltip_status:l.brandFollowTooltipStatus,timestamp:Date.now(),event_source:l.location.href,
schema_version:1}},processMetricEvent:function(a,b){f.processEvent(a,b)}}});"use strict";n.when("A","brand-follow-constants","brand-follow-button-tooltip","brand-follow-data-storage-helper","brand-follow-csm-helper").execute("brand-follow-tooltip-helper",function(g,b,a,e,f){var k=g.$,m;try{localStorage.setItem("brand_follow_localStorage_testing_key","brand_follow_localStorage_testing_key"),localStorage.removeItem("brand_follow_localStorage_testing_key"),m=!0}catch(w){m=!1}g.on("brandFollow:followButton:loaded",
function(){var e=b.FOLLOW_CSM_PREFIX+":tooltip";if(m){var t=localStorage.getItem(b.TOOLTIP_LAST_SEEN_KEY),B=localStorage.getItem(b.TOOLTIP_SEEN_COUNTER),x;if(x=h()){var y;try{y=a.getText()!==localStorage.getItem(b.TOOLTIP_LATEST_TEXT_KEY)}catch(C){y=!1}x=!y}if(x||!h()&&t&&!d(t,B)){l.brandFollowTooltipStatus=b.TOOLTIP_STATUS_NOT_SHOWN;return}}t=k(b.Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR);if(t.length)if(g.capabilities.mobile||g.capabilities.tablet||screen.width<=b.BREAKPOINTS.MOBILE){var v=t.get(0),
t=k(v).data(b.BFID_DATA_KEY);!t||c(t)?l.brandFollowTooltipStatus=b.TOOLTIP_STATUS_NOT_SHOWN:(a.show(v),r(),m&&localStorage.setItem(b.TOOLTIP_LATEST_TEXT_KEY,a.getText()),l.brandFollowTooltipStatus=b.TOOLTIP_STATUS_SHOWN,"true"!==l.tooltipSeenOnPage&&(q(),l.tooltipSeenOnPage="true",f.incrementCSMCounter(e+":mobile")),n(v)?p():k(l).scroll(g.throttle(function(){n(v)&&p()},200)))}else k(b.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).undelegate(b.Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR,"mouseenter mouseleave"),
k(b.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).delegate(b.Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR,"mouseenter mouseleave",function(d){if("mouseenter"===d.type){var h=k(d.target).data(b.BFID_DATA_KEY);!h||c(h)?l.brandFollowTooltipStatus=b.TOOLTIP_STATUS_NOT_SHOWN:(a.show(d.target),r(),m&&localStorage.setItem(b.TOOLTIP_LATEST_TEXT_KEY,a.getText()),l.brandFollowTooltipStatus=b.TOOLTIP_STATUS_SHOWN,"true"!==l.tooltipSeenOnPage&&(q(),l.tooltipSeenOnPage="true",f.incrementCSMCounter(e+":desktop")))}else"mouseleave"===
d.type&&a.hide()});else l.brandFollowTooltipStatus=b.TOOLTIP_STATUS_DISABLED});var h=function(){try{return"true"===localStorage.getItem(b.FOLLOWED_BRAND_TOOLTIP_SIGNAL)}catch(a){return!1}},c=function(a){try{return b.BRAND_FOLLOW_STATUS.FOLLOWING===e.getFollowStatus(a)}catch(c){return!1}},d=function(a,b){try{return Date.now()-parseInt(a)>6048E5*Math.pow(2,parseInt(b))}catch(c){return!1}},r=function(){m&&localStorage.setItem(b.TOOLTIP_LAST_SEEN_KEY,Date.now().toString())},n=function(a){a=a.getBoundingClientRect();
return 0<=a.top&&0<=a.left&&a.bottom<=(l.innerHeight||document.documentElement.clientHeight)&&a.right<=(l.innerWidth||document.documentElement.clientWidth)},p=function(){setTimeout(function(){a.hide()},b.TOOLTIP_DISPLAY_TIME)},q=function(){if(m){var a=localStorage.getItem(b.TOOLTIP_SEEN_COUNTER);a?(a=parseInt(a)+1,localStorage.setItem(b.TOOLTIP_SEEN_COUNTER,a.toString())):localStorage.setItem(b.TOOLTIP_SEEN_COUNTER,(1).toString())}}});"use strict";n.when("A","brand-follow-data-storage-helper","brand-follow-constants",
"brand-follow-csm-helper").register("brand-follow-shared-utils",function(g,b,a,e){var f=g.$;l.BrandFollowSharedUtils={getLastClickAction:function(k){var g=a.FOLLOW_CSM_PREFIX+":sharedUtils:getLastClickAction";e.incrementCSMCounter(g);var h;h=a.FOLLOW_CSM_PREFIX+":sharedUtils:getBFID";e.incrementCSMCounter(h);k?"string"===typeof k?h=k:k instanceof Element&&1===k.nodeType?((k=f(k).find(a.Brand_FOLLOW_BUTTON_SELECTOR).andSelf().filter(a.Brand_FOLLOW_BUTTON_SELECTOR).first().data(a.BFID_DATA_KEY))||e.incrementCSMCounter(h+
":notFound"),h=k):(e.incrementCSMCounter(h+":unknownInput"),h=void 0):h=void 0;h||e.incrementCSMCounter(g+":emptyBFID");(h=b.getLastClickEvent(h))||e.incrementCSMCounter(g+":emptyResponse");return h},isFollowing:function(e){return b.getFollowStatus(e)===a.BRAND_FOLLOW_STATUS.FOLLOWING}}});"use strict";n.when("A","brand-follow-data-storage-helper","brand-follow-constants").register("on-brand-follow-status-change",function(g,b,a){var e=g.$;g.state.bind("brand-follow-status",function(f,g){for(var m in g)g.hasOwnProperty(m)&&
g[m]&&(b.getFollowStatus(m)===a.BRAND_FOLLOW_STATUS.FOLLOWING?e("[data-bfid\x3d'"+m+"']").each(function(){e(this).text(e(this).data(a.FOLLOWING_TEXT_DATA_KEY));e(this).attr(a.ARIA_LABEL_KEY,e(this).data(a.ARIA_LABEL_FOLLOWING_DATA_KEY))}):e("[data-bfid\x3d'"+m+"']").each(function(){e(this).text(e(this).data(a.FOLLOW_TEXT_DATA_KEY));e(this).attr(a.ARIA_LABEL_KEY,e(this).data(a.ARIA_LABEL_FOLLOW_DATA_KEY))}))})});"use strict";n.when("A").register("brand-follow-button-event-helper",function(g){return{triggerFollowButtonLoadedEvent:function(){g.trigger("brandFollow:followButton:loaded")},
triggerFollowButtonRedirectionEvent:function(b){g.trigger("brandFollow:followButton:redirectToAuthPortal",b)}}});"use strict";n.when("A","brand-follow-data-storage-helper","brand-follow-constants","brand-follow-afs-helper","brand-follow-auth-portal-link-builder","brand-follow-button-event-helper","brand-follow-metrics-client","brand-follow-csm-helper").register("brand-follow-button-click-handler",function(g,b,a,e,f,k,m,h){var c=g.$;g.on("brandFollow:followButton:loaded",function(){c(a.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).undelegate(a.Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR,
"click");c(a.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).delegate(a.Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR,"click",function(d){var g=a.FOLLOW_CSM_PREFIX+":clickHandler";h.incrementCSMCounter(g);var n=c(this).find(a.Brand_FOLLOW_BUTTON_SELECTOR).first(),p=n.data(a.BFID_DATA_KEY);if(p){var q=b.getFollowStatus(p);q||(q=n.data(a.FOLLOW_STATUS_DATA_KEY)?a.BRAND_FOLLOW_STATUS.FOLLOWING:a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);switch(q){case a.BRAND_FOLLOW_STATUS.FOLLOWING:h.incrementCSMCounter(g+":status:following");
b.setFollowStatus(p,a.BRAND_FOLLOW_STATUS.PENDING);b.setLastClickEvent(p,a.EVENT_TYPE.UNFOLLOW);e.unfollow(p,function(){b.setFollowStatus(p,a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);var c=m.buildFollowButtonClickMetricEvent(n,a.EVENT_TYPE.UNFOLLOW,d);m.processMetricEvent(c,{n:1})},function(){b.setFollowStatus(p,a.BRAND_FOLLOW_STATUS.FOLLOWING)});break;case a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING:h.incrementCSMCounter(g+":status:not_following");b.setFollowStatus(p,a.BRAND_FOLLOW_STATUS.PENDING);b.setLastClickEvent(p,
a.EVENT_TYPE.FOLLOW);e.follow(p,function(){b.setFollowStatus(p,a.BRAND_FOLLOW_STATUS.FOLLOWING);var c=m.buildFollowButtonClickMetricEvent(n,a.EVENT_TYPE.FOLLOW,d);m.processMetricEvent(c,{n:1});try{localStorage.setItem(a.FOLLOWED_BRAND_TOOLTIP_SIGNAL,"true")}catch(e){}},function(){b.setFollowStatus(p,a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING)},function(){k.triggerFollowButtonRedirectionEvent(d);var a=f.signin();l.location.assign(a)});break;case a.BRAND_FOLLOW_STATUS.NOT_SIGNED_IN:h.incrementCSMCounter(g+
":status:not_signed_in");k.triggerFollowButtonRedirectionEvent(d);g=f.signin();l.location.assign(g);break;case a.BRAND_FOLLOW_STATUS.ERROR:h.incrementCSMCounter(g+":status:error");k.triggerFollowButtonLoadedEvent();break;case a.BRAND_FOLLOW_STATUS.PENDING:return h.incrementCSMCounter(g+":status:pending"),!1;default:h.incrementCSMCounter(g+":status:unknown")}}else h.incrementCSMCounter(g+":emptyBFID")})})});"use strict";n.when("A","brand-follow-data-storage-helper","brand-follow-constants","brand-follow-afs-helper",
"brand-follow-button-event-helper","brand-follow-csm-helper","on-brand-follow-status-change","ready").register("brand-follow-button-initializer",function(g,b,a,e,f,k){g.on("brandFollow:followButton:loaded",function(){g.$(a.Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR+" "+a.Brand_FOLLOW_BUTTON_SELECTOR).each(function(){var f=g.$(this),h=f.data(a.BFID_DATA_KEY);if(h!==p){var c=b.getFollowStatus(h);if(c===p||c===a.BRAND_FOLLOW_STATUS.ERROR){c=f.data(a.FOLLOW_STATUS_DATA_KEY);if(f.data(a.BACK_BUTTON_SUPPORT_ENABLED_DATA_KEY)){var d=
l.performance||l.webkitPerformance,d=d&&d.navigation&&2==d.navigation.type;!/bot|crawl|spider/i.test(l.navigator&&l.navigator.userAgent)&&d&&(c="")}if(""!==c)b.setFollowStatus(h,c?a.BRAND_FOLLOW_STATUS.FOLLOWING:a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);else{b.setFollowStatus(h,a.BRAND_FOLLOW_STATUS.PENDING);var n=a.FOLLOW_CSM_PREFIX+":FetchFollowStatus";k.incrementCSMCounter(""+n);e.getFollowStatusAndInitCsrf(h,function(c){b.setFollowStatus(h,c.isFollowing?a.BRAND_FOLLOW_STATUS.FOLLOWING:a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);
k.incrementCSMCounter(n+":success");f.data(a.FOLLOW_STATUS_DATA_KEY)!==c.isFollowing&&k.incrementCSMCounter(n+":FoundDiff")},function(){k.incrementCSMCounter(n+":error");b.setFollowStatus(h,a.BRAND_FOLLOW_STATUS.ERROR)},function(){k.incrementCSMCounter(n+":notSignedIn");b.setFollowStatus(h,a.BRAND_FOLLOW_STATUS.NOT_SIGNED_IN)})}}else c===a.BRAND_FOLLOW_STATUS.FOLLOWING?(f.text(f.data(a.FOLLOWING_TEXT_DATA_KEY)),f.attr(a.ARIA_LABEL_KEY,f.data(a.ARIA_LABEL_FOLLOWING_DATA_KEY))):(f.text(f.data(a.FOLLOW_TEXT_DATA_KEY)),
f.attr(a.ARIA_LABEL_KEY,f.data(a.ARIA_LABEL_FOLLOW_DATA_KEY)))}})});f.triggerFollowButtonLoadedEvent()});"use strict";n.when("A","brand-follow-constants","brand-follow-button-event-helper","ready").execute("brand-follow-button-mutation-observer",function(g,b,a){var e=g.$;(function(){var f=l.MutationObserver||l.WebKitMutationObserver||l.MozMutationObserver;f!==p&&(new f(function(f,g){var h;g=!1;for(var c=0;c<f.length;c++){h=f[c];if("childList"!==h.type)break;h=h.addedNodes;for(var d,l=0;l<h.length;l++)if(d=
h[l],0!==e(d).find(b.Brand_FOLLOW_BUTTON_SELECTOR).length){g=!0;break}if(g){a.triggerFollowButtonLoadedEvent();break}}})).observe(document,{childList:!0,subtree:!0})})()})});